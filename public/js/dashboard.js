"use strict";function getMetaContent(e){var t=document.getElementsByTagName("meta"),a=new RegExp("\\b"+e+"\\b","i"),n=0,i=t.length;for(n;n<i;n++)if(a.test(t[n].getAttribute("name")))return t[n].getAttribute("content");return""}function ajax(e,t,a){var n=new XMLHttpRequest,t=JSON.stringify(t);n.onreadystatechange=function(){4==n.readyState&&200==n.status&&a.call(JSON.parse(n.responseText))},n.open("POST",e),n.setRequestHeader("Content-type","application/json"),n.setRequestHeader("X-CSRF-TOKEN",getMetaContent("csrf-token")),n.send(t)}function insertAfter(e,t){if(e&&t){var a=t.parentNode;t.nextSibling&&a?a.insertBefore(e,t.nextSibling):a&&a.appendChild(e)}}function submitPreventDefault(e){e.addEventListener("submit",function(e){e.preventDefault()})}function createNotice(e,t,a,n){document.getElementsByClassName(t+"--notice")[0]&&removeNotice(t);var i=document.createElement("span");if(i.innerHTML=a,n)var s="notice notice--margin "+t+"--notice";else var s="notice "+t+"--notice";i.setAttribute("class",s),insertAfter(i,e),e.style.border="2px solid #cc181e"}function removeNotice(e){document.getElementsByClassName(e+"--notice")[0]&&(document.getElementsByClassName(e+"--notice")[0].remove(),document.getElementsByClassName(e)[0].removeAttribute("style"))}function removeAllNotices(){for(var e=0;e<arguments.length;e++)removeNotice(arguments[e])}function clearForm(){for(var e=0;e<arguments.length;e++)document.getElementsByClassName(arguments[e])[0].value="",document.getElementsByClassName(arguments[e])[0].removeAttribute("style"),document.getElementsByClassName(arguments[e]+"--notice")[0]&&document.getElementsByClassName(arguments[e]+"--notice")[0].remove()}function removeNoticeOnFocus(){for(var e=0;e<arguments.length;e++)document.getElementsByClassName(arguments[e])[0].addEventListener("focus",function(e){removeNotice(e.target.className.split(" ")[1])})}function b64toBlob(e,t,a){t=t||"",a=a||512;for(var n=atob(e),i=[],s=0;s<n.length;s+=a){for(var r=n.slice(s,s+a),o=new Array(r.length),d=0;d<r.length;d++)o[d]=r.charCodeAt(d);var l=new Uint8Array(o);i.push(l)}return new Blob(i,{type:t})}function createModal(e,t,a){function n(){o.remove()}function i(){location.reload()}var s=document.getElementsByClassName("wrap-modal")[0],r=document.createElement("div");r.className="modal",r.innerHTML='<span class="modal__text">'+e+"</span>",r.innerHTML+='<button class="modal__button">'+t+"</button>",s.appendChild(r),s.classList.remove("wrap-modal--hidden");var o=s.getElementsByClassName("modal")[0],d=o.getElementsByClassName("modal__button")[0];s.addEventListener("click",function(e){e.target===s&&(s.classList.add("wrap-modal--hidden"),setTimeout(n,100),a&&setTimeout(i,100))}),d.addEventListener("click",function(e){s.classList.add("wrap-modal--hidden"),setTimeout(n,100),a&&setTimeout(i,100)})}function getGetParameters(){return location.search.substr(1)}function getGetParameter(e){var t=null,a=[];return location.search.substr(1).split("&").forEach(function(n){a=n.split("="),a[0]===e&&(t=decodeURIComponent(a[1]))}),t}function ready(){function e(e,t,a,n){function i(){d.remove()}function s(){window.location=n}var r=document.getElementsByClassName("wrap-modal")[0],o=document.createElement("div");o.className="modal",o.innerHTML='<span class="modal__text">'+e+"</span>",o.innerHTML+='<button class="modal__button">'+t+"</button>",r.appendChild(o),r.classList.remove("wrap-modal--hidden");var d=r.getElementsByClassName("modal")[0],l=d.getElementsByClassName("modal__button")[0];r.addEventListener("click",function(e){e.target===r&&(r.classList.add("wrap-modal--hidden"),setTimeout(i,100),a&&setTimeout(s,100))}),l.addEventListener("click",function(e){r.classList.add("wrap-modal--hidden"),setTimeout(i,100),a&&setTimeout(s,100)})}function t(e,t){t.classList.contains("painting-form__upload-button--hidden")?(t.classList.remove("painting-form__upload-button--hidden"),e.parentNode.classList.add("painting-form__wrap-preview--hidden")):e.parentNode.classList.contains("painting-form__wrap-preview--hidden")&&(e.parentNode.classList.remove("painting-form__wrap-preview--hidden"),t.classList.add("painting-form__upload-button--hidden"))}function a(e,t,a,n){document.getElementsByClassName(t+"--notice")[0]&&removeNotice(t);var i=document.createElement("span");if(i.innerHTML=a,n)var s="painting-form-notice notice--margin "+t+"--notice";else var s="painting-form-notice "+t+"--notice";i.setAttribute("class",s),insertAfter(i,e),e.style.border="2px solid #cc181e"}function n(e,t){t.classList.contains("featured-form__upload-button--hidden")?(t.classList.remove("featured-form__upload-button--hidden"),e.parentNode.classList.add("featured-form__wrap-preview--hidden")):e.parentNode.classList.contains("featured-form__wrap-preview--hidden")&&(e.parentNode.classList.remove("featured-form__wrap-preview--hidden"),t.classList.add("featured-form__upload-button--hidden"))}if(document.getElementsByClassName("painting-form")[0]){var i=document.getElementsByClassName("painting-form")[0],s=i.getElementsByClassName("painting-form__input--name")[0],r=i.getElementsByClassName("painting-form__input--link")[0],o=i.getElementsByClassName("painting-form__input--price")[0],d=i.getElementsByClassName("painting-form__textarea--description")[0],l=i.getElementsByClassName("painting-form__select--category")[0],m=i.getElementsByClassName("painting-form__select--size")[0],c=i.getElementsByClassName("painting-form__select--orientation")[0],u=i.getElementsByClassName("painting-form__preview"),f=i.getElementsByClassName("painting-form__image-input"),g=i.getElementsByClassName("painting-form__upload-button"),_=i.getElementsByClassName("painting-form__delete-preview"),v=i.getElementsByClassName("painting-form__images-notice")[0],p=i.getElementsByClassName("painting-form__submit")[0];if(i.classList.contains("painting-form--add"))var h="add";else if(i.classList.contains("painting-form--edit"))var h="edit";removeNoticeOnFocus("painting-form__input--name","painting-form__input--link","painting-form__input--price","painting-form__textarea--description");for(var y=0;y<g.length;y++)g[y].addEventListener("click",function(e){var t=e.currentTarget.parentElement.getElementsByClassName("painting-form__image-number")[0].value;f[t].click()}),_[y].addEventListener("click",function(e){var a=e.currentTarget.parentElement.parentElement.parentElement.getElementsByClassName("painting-form__image-number")[0].value;u[a].removeAttribute("style"),f[a].value="",t(u[a],g[a])}),f[y].addEventListener("change",function(e){var a=e.currentTarget.parentElement.getElementsByClassName("painting-form__image-number")[0].value,n=f[a].files[0];if(n&&n.type.match(/image.*/)){var i=new FileReader;i.onload=function(e){return function(e){t(u[a],g[a]),u[a].setAttribute("style","background-image: url("+e.target.result+")")}}(),i.readAsDataURL(n)}});p.addEventListener("click",function(){p.disabled=!0;for(var t=[],n=0;n<u.length;n++)t[n]=u[n].style.backgroundImage.substring(5,u[n].style.backgroundImage.length-2);var i={images:t,name:s.value,link:r.value,price:o.value,description:d.value,category:l.value,size:m.value,orientation:c.value};if("add"===h)var f="/dashboard/painting/add",g="The painting was successfully added!",_=!0,y="/dashboard/paintings";else if("edit"===h){var f="/dashboard/painting/edit",g="The painting was successfully updated!",_=!1,y="";i.id=document.getElementsByClassName("painting-form__id")[0].value}ajax(f,i,function(){removeAllNotices("painting-form__input--name","painting-form__input--link","painting-form__input--price","painting-form__textarea--description","painting-form__select--category","painting-form__select--size","painting-form__select--orientation"),v.innerHTML="",this.status?e(g,"Got it!",_,y):(""!=this.data.images&&(v.innerHTML=this.data.images),""!=this.data.name&&a(s,"painting-form__input--name",this.data.name,!1),""!=this.data.link&&a(r,"painting-form__input--link",this.data.link,!1),""!=this.data.price&&a(o,"painting-form__input--price",this.data.price,!1),""!=this.data.description&&a(d,"painting-form__textarea--description",this.data.description,!1),""!=this.data.category&&a(l,"painting-form__select--category",this.data.category,!1),""!=this.data.size&&a(m,"painting-form__select--category",this.data.size,!1),""!=this.data.orientation&&a(c,"painting-form__select--orientation",this.data.orientation,!1)),p.disabled=!1})})}if(document.getElementById("painting__delete-button")){var E=document.getElementById("painting__delete-button"),b=document.getElementsByClassName("painting-form__id")[0];E.addEventListener("click",function(){confirm("Delete this painting?")&&ajax("/dashboard/painting/delete",{id:b.value},function(){this.status?e("The painting was successfully deleted!","Got it!",!0,"/dashboard/paintings"):console.log(this.data.error)})})}if(document.getElementById("painting__set-available-button")){var E=document.getElementById("painting__set-available-button"),b=document.getElementsByClassName("painting-form__id")[0];E.addEventListener("click",function(){confirm("Make this picture available again?")&&ajax("/dashboard/painting/available",{id:b.value},function(){this.status?e("The painting was successfully updated!","Got it!",!1,"/dashboard/paintings"):console.log(this.data.error)})})}if(document.getElementById("order__delete-button")){var E=document.getElementById("order__delete-button"),b=document.getElementsByClassName("dashboard-order__id")[0];E.addEventListener("click",function(){confirm("Delete this order?")&&ajax("/dashboard/order/delete",{id:b.innerHTML},function(){this.status?e("The order was successfully deleted!","Got it!",!0,"/dashboard/orders"):console.log(this.data.error)})})}if(document.getElementsByClassName("event-form")[0]){var N=document.getElementsByClassName("event-form")[0],B=N.getElementsByClassName("event-form__date")[0],C=N.getElementsByClassName("event-form__text")[0],L=N.getElementsByClassName("event-form__submit")[0];B.addEventListener("focus",function(e){e.currentTarget.getAttribute("style")&&e.currentTarget.removeAttribute("style"),document.getElementsByClassName("event-form__date--notice")[0]&&document.getElementsByClassName("event-form__date--notice")[0].remove()}),C.addEventListener("focus",function(e){e.currentTarget.getAttribute("style")&&e.currentTarget.removeAttribute("style"),document.getElementsByClassName("event-form__text--notice")[0]&&document.getElementsByClassName("event-form__text--notice")[0].remove()}),L.addEventListener("click",function(){if(L.disabled=!0,N.classList.contains("event-form--add")){var t={date:B.value,text:C.value};ajax("/dashboard/event/add",t,function(){removeAllNotices("event-form__date","event-form__text"),this.status?e("The event was successfully added!","Got it!",!0,"/dashboard/events"):(""!=this.data.date&&createNotice(B,"event-form__date",this.data.date,!1),""!=this.data.text&&createNotice(C,"event-form__text",this.data.text,!1)),L.disabled=!1})}else if(N.classList.contains("event-form--edit")){var a=N.getElementsByClassName("event-form__id")[0],t={id:a.value,date:B.value,text:C.value};ajax("/dashboard/event/edit",t,function(){removeAllNotices("event-form__date","event-form__text"),this.status?e("The event was successfully updated!","Got it!",!1):(""!=this.data.date&&createNotice(B,"event-form__date",this.data.date,!1),""!=this.data.text&&createNotice(C,"event-form__text",this.data.text,!1)),L.disabled=!1})}})}if(document.getElementById("event__delete-button")){var E=document.getElementById("event__delete-button"),b=document.getElementsByClassName("event-form__id")[0];E.addEventListener("click",function(){confirm("Delete this event?")&&ajax("/dashboard/event/delete",{id:b.value},function(){this.status?e("The event was successfully deleted!","Got it!",!0,"/dashboard/events"):console.log(this.data.error)})})}if(document.getElementsByClassName("dashboard-header__button--update-featured")[0]){var T,w=document.getElementsByClassName("dashboard-header__button--update-featured")[0],k=document.getElementsByClassName("dashboard-featured__radio");w.addEventListener("click",function(){for(var t=0;t<k.length;t++)if(k[t].checked){T=k[t].id;break}var a={id:T};w.innerHTML="Saving...",ajax("/dashboard/featured/update",a,function(){w.innerHTML="Save changes",e("The featured artist was successfully updated!","Got it!",!1)})})}if(document.getElementsByClassName("featured-form")[0]){var x=document.getElementsByClassName("featured-form")[0],A=x.getElementsByClassName("featured-form__artist")[0],M=x.getElementsByClassName("featured-form__images-notice")[0],H=x.getElementsByClassName("featured-form__preview"),I=x.getElementsByClassName("featured-form__image-input"),j=x.getElementsByClassName("featured-form__upload-button"),G=x.getElementsByClassName("featured-form__delete-preview"),R=x.getElementsByClassName("featured-form__submit")[0];A.addEventListener("focus",function(e){e.currentTarget.getAttribute("style")&&e.currentTarget.removeAttribute("style"),document.getElementsByClassName("featured-form__artist--notice")[0]&&document.getElementsByClassName("featured-form__artist--notice")[0].remove()});for(var y=0;y<j.length;y++)j[y].addEventListener("click",function(e){var t=e.currentTarget.parentElement.getElementsByClassName("featured-form__image-number")[0].value;I[t].click()}),G[y].addEventListener("click",function(e){var t=e.currentTarget.parentElement.parentElement.parentElement.getElementsByClassName("featured-form__image-number")[0].value;H[t].removeAttribute("style"),I[t].value="",n(H[t],j[t])}),I[y].addEventListener("change",function(e){var t=e.currentTarget.parentElement.getElementsByClassName("featured-form__image-number")[0].value,a=I[t].files[0];if(a&&a.type.match(/image.*/)){var i=new FileReader;i.onload=function(e){return function(e){n(H[t],j[t]),H[t].setAttribute("style","background-image: url("+e.target.result+")")}}(),i.readAsDataURL(a)}});R.addEventListener("click",function(){R.disabled=!0;for(var t=[],a=0;a<H.length;a++)t[a]=H[a].style.backgroundImage.substring(5,H[a].style.backgroundImage.length-2);ajax("/dashboard/featured/add",{artist:A.value,images:t},function(){removeAllNotices("featured-form__artist"),M.innerHTML="",this.status?e("The featured artist was successfully added!","Got it!",!0,"/dashboard/featured"):(""!=this.data.images&&(M.innerHTML=this.data.images),""!=this.data.artist&&createNotice(A,"featured-form__artist",this.data.artist,!1)),R.disabled=!1})})}if(document.getElementsByClassName("dashboard-featured__remove-button"))for(var D=document.getElementsByClassName("dashboard-featured__remove-button"),y=0;y<D.length;y++)D[y].addEventListener("click",function(t){var a=t.currentTarget.parentElement.parentElement.getElementsByClassName("dashboard-featured__radio")[0].id;confirm("Delete this featured artist?")&&ajax("/dashboard/featured/delete",{id:a},function(){this.status?e("The featured artist was successfully deleted!","Got it!",!0,"/dashboard/featured"):console.log(this.data.error)})})}document.addEventListener("DOMContentLoaded",ready);